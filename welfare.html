<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <title>昶青集團職工福利委員會聯合會</title>
    <!-- 載入 Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <style>
      /* ----- Reset & Global ----- */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        -webkit-tap-highlight-color: transparent;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      html {
        height: 100%;
      }

      body {
        font-family: -apple-system, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        min-height: 100%;
        background: linear-gradient(135deg, #fad0c4 30%, #ff9a9e 50%, #a18cd1 100%);
        background-size: 250% 250%;
        -webkit-animation: gradientBG 15s ease infinite;
        animation: gradientBG 15s ease infinite;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 8px;
        position: relative;
        overflow-x: hidden;
        -webkit-overflow-scrolling: touch;
        transform: translateZ(0);
      }

      @-webkit-keyframes gradientBG {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      @keyframes gradientBG {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }

      /* ----- Floating Letters (T, C, C) ----- */
      .letter {
        position: fixed;
        font-weight: bold;
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: -3;
        text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        opacity: 0;
        transform: scale(0);
      }
      
      .letter-t {
        color: #00bfff;
        animation: letterExplosion 1s forwards, moveRandom-T 90s infinite alternate ease-in-out, sizeChange-T 24s infinite alternate ease-in-out, colorChange-1 84s infinite;
      }
      
      .letter-c1 {
        color: #00ff7f;
        animation: letterExplosion 1s 0.2s forwards, moveRandom-C1 96s infinite alternate ease-in-out, sizeChange-C1 27s infinite alternate ease-in-out, colorChange-2 87s infinite;
      }
      
      .letter-c2 {
        color: #f09707;
        animation: letterExplosion 1s 0.4s forwards, moveRandom-C2 102s infinite alternate ease-in-out, sizeChange-C2 30s infinite alternate ease-in-out, colorChange-3 90s infinite;
      }
      
      @keyframes letterExplosion {
        0% {
          opacity: 0;
          transform: scale(0) rotate(0deg);
        }
        50% {
          opacity: 1;
          transform: scale(3) rotate(180deg);
        }
        100% {
          opacity: 0.8;
          transform: scale(1) rotate(360deg);
        }
      }

      @keyframes moveRandom-T {
        0% { top: 10%; left: 10%; }
        10% { top: 40%; left: 80%; }
        20% { top: 80%; left: 15%; }
        30% { top: 30%; left: 60%; }
        40% { top: 70%; left: 30%; }
        50% { top: 20%; left: 50%; }
        60% { top: 60%; left: 20%; }
        70% { top: 50%; left: 70%; }
        80% { top: 15%; left: 40%; }
        90% { top: 90%; left: 90%; }
        100% { top: 50%; left: 50%; }
      }
      
      @keyframes moveRandom-C1 {
        0% { top: 90%; left: 20%; }
        10% { top: 20%; left: 40%; }
        20% { top: 50%; left: 85%; }
        30% { top: 80%; left: 10%; }
        40% { top: 40%; left: 60%; }
        50% { top: 60%; left: 30%; }
        60% { top: 30%; left: 70%; }
        70% { top: 70%; left: 50%; }
        80% { top: 25%; left: 90%; }
        90% { top: 55%; left: 15%; }
        100% { top: 30%; left: 30%; }
      }
      
      @keyframes moveRandom-C2 {
        0% { top: 50%; left: 50%; }
        10% { top: 70%; left: 20%; }
        20% { top: 30%; left: 80%; }
        30% { top: 60%; left: 40%; }
        40% { top: 20%; left: 70%; }
        50% { top: 80%; left: 30%; }
        60% { top: 10%; left: 60%; }
        70% { top: 90%; left: 10%; }
        80% { top: 40%; left: 90%; }
        90% { top: 15%; left: 25%; }
        100% { top: 75%; left: 75%; }
      }
      
      @keyframes sizeChange-T {
        0%, 100% { font-size: 40px; }
        20% { font-size: 60px; }
        40% { font-size: 30px; }
        60% { font-size: 70px; }
        80% { font-size: 50px; }
      }
      
      @keyframes sizeChange-C1 {
        0%, 100% { font-size: 50px; }
        25% { font-size: 35px; }
        50% { font-size: 65px; }
        75% { font-size: 45px; }
      }
      
      @keyframes sizeChange-C2 {
        0%, 100% { font-size: 45px; }
        33% { font-size: 70px; }
        66% { font-size: 35px; }
      }
      @keyframes colorChange-1 {
        0%, 100% { color: #00bfff; }
        33% { color: #00ff7f; }
        66% { color: #ff4500; }
      }
      @keyframes colorChange-2 {
        0%, 100% { color: #00ff7f; }
        33% { color: #ff4500; }
        66% { color: #00bfff; }
      }
      @keyframes colorChange-3 {
        0%, 100% { color: #ff4500; }
        33% { color: #00bfff; }
        66% { color: #00ff7f; }
      }

      /* ----- Container & Heading ----- */
      .container {
        position: relative;
        background: rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(5px);
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.1);
        max-width: 1200px;
        width: 100%;
      }
      .container::before {
        content: "";
        position: absolute;
        top: 0; left: 0;
        width: 100px; height: 100px;
        background: linear-gradient(135deg, #ff9a9e 0%, transparent 70%);
        opacity: 0.3;
        border-top-left-radius: 30px;
      }
      .container::after {
        content: "";
        position: absolute;
        bottom: 0; right: 0;
        width: 100px; height: 40px;
        background: linear-gradient(315deg, #fad0c4 0%, transparent 70%);
        opacity: 0.3;
        border-bottom-right-radius: 30px;
      }

      h2 {
        text-align: center;
        color: #8e44ad;
        margin-bottom: 20px;
        font-size: 2.5em;
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        position: relative;
        padding-bottom: 15px;
        margin-top: 20px;
      }
      .logo-img {
        max-width: 200px;
        margin: 25px auto 0; 
        display: block;
        border-radius: 0px;
        box-shadow: 0 3px 8px rgba(0,0,0,0);
      }
      h2::after {
        content: "";
        position: absolute;
        bottom: 0; left: 50%;
        transform: translateX(-50%);
        width: 300px; height: 4px;
        background: linear-gradient(90deg, #ff9a9e, #fad0c4);
        border-radius: 30px;
        margin-bottom: 5px;
      }

      .form-group {
        margin-bottom: 5px;
        margin-bottom: 10px;
        display: flex;
        flex-direction: column;
        position: relative;
      }

      label {
        margin-bottom: 5px;
        font-weight: bold;
        color: #8e44ad;
        font-size: 1.4em;
        display: flex;
        align-items: center;
      }
      label::before {
        content: "";
        display: inline-block;
        width: 8px; height: 25px;
        background: linear-gradient(to bottom, #ff9a9e, #a18cd1);
        margin-right: 10px;
        border-radius: 20px;
      }

      select, button, input[type="text"], input[type="password"] {
        padding: 15px 15px;
        border: 2px solid rgba(161, 140, 209, 0.3);
        border-radius: 20px;
        font-size: 1.1em;
        outline: none;
        transition: all 0.3s ease;
        background-color: rgba(255, 255, 255, 0.5);
        box-shadow: 0 4px 10px rgba(0,0,0,0.05), inset 0 2px 5px rgba(255,255,255,0.5);
        min-height: 40px;
      }
      input::placeholder {
        font-size: 1.2em;
      }
      input[type="text"]:focus, input[type="password"]:focus, select:focus {
        border-color: #a18cd1;
        box-shadow: 0 0 15px rgba(161, 140, 209, 0.5), inset 0 2px 5px rgba(255,255,255,0.6);
        background-color: rgba(255, 255, 255, 0.5);
      }
      button {
        background: linear-gradient(45deg, #a18cd1, #fbc2eb);
        color: white;
        cursor: pointer;
        box-shadow: 0 8px 15px rgba(161, 140, 209, 0.3), 0 4px 6px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        font-size: 1.3em;        
        border: none;
        position: relative;
        overflow: hidden;
        text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        font-weight: bold;
        transform: translateZ(0);
      }
      button:hover {
        background: linear-gradient(45deg, #fbc2eb, #a18cd1);
        box-shadow: 0 10px 20px rgba(161, 140, 209, 0.4), 0 6px 10px rgba(0,0,0,0.15);
        transform: translateY(-2px);
      }
      button:active {
        transform: translateY(1px);
        box-shadow: 0 5px 10px rgba(161, 140, 209, 0.3);
      }

      /* 返回按鈕 */
      #backButton {
        position: absolute;
        top: 10px; right: 10px;
        padding: 8px 15px;
        background: linear-gradient(45deg, #6c5ce7, #a29bfe);
        color: white; border: none; border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 6px 15px rgba(108, 92, 231, 0.3), 0 3px 8px rgba(0,0,0,0.15);
        transition: all 0.3s ease;
        font-size: 0.8em; font-weight: bold;
        display: flex; align-items: center; justify-content: center;
        min-height: 30px;
      }
      #backButton:hover {
        background: linear-gradient(45deg, #a29bfe, #6c5ce7);
        box-shadow: 0 8px 20px rgba(108, 92, 231, 0.5), 0 5px 12px rgba(0,0,0,0.2);
        transform: translateY(-2px);
      }
      #backButton:active {
        background: linear-gradient(45deg, #5045cd, #6c5ce7);
      }
      #backButton::before {
        content: "🔙";
        margin-right: 8px;
        font-size: 0.8em;
        display: inline-block;
        transition: all 0.3s ease;
      }

      /* User Info */
      #userInfo {
        position: absolute;
        top: 60px; right: 10px;
        padding: 5px;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(5px);
        border-radius: 10px;
        font-size: 0.6em;
        color: #8e44ad;
        box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        text-align: right;
        min-width: 77px;  
        width: auto;
      }
      #userName {
        font-weight: bold;
        font-size: 1em;
      }

      /* 按鈕點擊效果 */
      .button-clicked {
        animation: buttonClick 0.5s;
      }
      @keyframes buttonClick {
        0% { transform: scale(1); }
        50% { transform: scale(0.95); }
        100% { transform: scale(1); }
      }

      /* 福委會頁面特有樣式 */
      .welfare-content {
        margin-top: 30px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      }

      .welfare-section {
        margin-bottom: 30px;
      }

      .welfare-section h3 {
        color: #8e44ad;
        font-size: 1.5em;
        margin-bottom: 15px;
        border-bottom: 2px solid rgba(161, 140, 209, 0.5);
        padding-bottom: 8px;
      }

      .welfare-section p {
        font-size: 1.1em;
        line-height: 1.6;
        color: #333;
        margin-bottom: 10px;
      }

      .welfare-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .welfare-card {
        background: rgba(255, 255, 255, 0.5);
        border-radius: 12px;
        padding: 15px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
      }

      .welfare-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0,0,0,0.15);
      }

      .welfare-card h4 {
        color: #8e44ad;
        margin-bottom: 10px;
        font-size: 1.2em;
      }

      .welfare-card p {
        font-size: 0.9em;
        color: #555;
      }

      /* 添加到現有 CSS 中 */
      #loadingAnnouncements {
        text-align: center;
        padding: 20px;
        color: #8e44ad;
        font-style: italic;
      }
      
      .error-message {
        color: #e74c3c;
        text-align: center;
        padding: 15px;
        background: rgba(255, 255, 255, 0.7);
        border-radius: 10px;
        margin: 10px 0;
      }
      
      .welfare-card {
        opacity: 0;
        transform: translateY(20px);
      }

      .error-card {
  background-color: #fff;
  border-radius: 10px;
  padding: 20px;
  text-align: center;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  width: 100%;
  margin: 10px 0;
}

.error-message {
  color: #e74c3c;
  margin-bottom: 15px;
}

.retry-button {
  background-color: #8e44ad;
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
  font-weight: bold;
  transition: background-color 0.3s;
}

.retry-button:hover {
  background-color: #9b59b6;
}



      @media (max-width: 820px) {
        .container { padding: 30px; }
        h2 { font-size: 2em; }
        label { font-size: 1.3em; }
        select, button, input[type="text"], input[type="password"] { font-size: 1.2em; }
        .welfare-grid { grid-template-columns: 1fr; }
      }

      @media only screen and (max-width: 820px) and (-webkit-min-device-pixel-ratio: 2) {
        h2 { font-size: 1.8em; }
        label { font-size: 1em; }
        select, button, input[type="text"], input[type="password"] { font-size: 1.2em; padding: 12px 12px; }
        #backButton { font-size: 0.8em; }
      }

      @media (max-width: 820px) {
        .container { padding: 15px; }
        #userInfo { top: 50px; right: 10px; font-size: 0.8em; }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <img src="昶青實業LOGO確定版-PNG.png" alt="TCC" class="logo-img">
      <h2>昶青集團職工福利委員會聯合會</h2>
      
      <button id="backButton" onclick="backToDataCenter()">返回數資中心</button>
      <div id="userInfo">
        歡迎, <span id="userName"></span>
        <div id="userRole"></div>
      </div>
      
      <div class="welfare-content">
        <div class="welfare-section">
          <h3>福委會簡介</h3>
          <p>昶青集團職工福利委員會聯合會，旨在促進員工福利，增進員工身心健康，提升工作士氣與向心力。本會由各事業單位福委會代表組成，定期舉辦各項活動與福利措施。</p>
        </div>

    <div class="welfare-section">
  <h3>最新公告</h3>
  <div class="welfare-grid" id="announcementGrid">
    <!-- 公告內容將由 JavaScript 動態生成 -->
    <div id="loadingAnnouncements">載入公告中...</div>
  </div>
</div>

<div class="welfare-section">
  <h3>福利項目</h3>
  <div class="welfare-grid" id="benefitsGrid">
    <!-- 福利項目將由 JavaScript 動態生成或靜態定義 -->
  </div>
</div>

<div class="welfare-section">
  <h3>福利項目</h3>
  <div class="welfare-grid">
    <div class="welfare-card">
      <h4>結婚補助</h4>
      <p>員工本人結婚，補助新台幣6,000元整。</p>
    </div>
    <div class="welfare-card">
      <h4>生育補助</h4>
      <p>員工本人或配偶生育，每胎補助新台幣6,000元整。</p>
    </div>
    <div class="welfare-card">
      <h4>住院補助</h4>
      <p>員工本人住院，每日補助新台幣1,000元，最高補助10日。</p>
    </div>
    <div class="welfare-card">
      <h4>員工旅遊</h4>
      <p>每年舉辦員工旅遊，依年資提供不同補助金額。</p>
    </div>
    <div class="welfare-card">
      <h4>節慶禮金/禮品</h4>
      <p>端午節、中秋節及春節發放禮金或禮品。</p>
    </div>
    <div class="welfare-card">
      <h4>子女教育獎學金</h4>
      <p>員工子女就學成績優良者，可申請獎學金。</p>
    </div>
  </div>
</div>

      
      <h6 style="text-align: center; color: #808080; margin-top: 20px;">Designed by T.C.C.管理本部</h6>
    </div>
    
    <script>
      /*************************************************
       * 1) 字母特效
       *************************************************/
      window.onload = function() {
        createTCCLetters();
        updateUserInfo();
        fetchAnnouncements();
       displayBenefitItems(); // 新增顯示福利項目的函數
      };

      // 顯示福利項目
function displayBenefitItems() {
  const benefitsGrid = document.getElementById('benefitsGrid');
  
  // 福利項目數據 - 可以改為從服務器獲取
  const benefits = [
    { title: "結婚補助", content: "員工本人結婚，補助新台幣6,000元整。" },
    { title: "生育補助", content: "員工本人或配偶生育，每胎補助新台幣6,000元整。" },
    { title: "住院補助", content: "員工本人住院，每日補助新台幣1,000元，最高補助10日。" },
    { title: "員工旅遊", content: "每年舉辦員工旅遊，依年資提供不同補助金額。" },
    { title: "節慶禮金/禮品", content: "端午節、中秋節及春節發放禮金或禮品。" },
    { title: "子女教育獎學金", content: "員工子女就學成績優良者，可申請獎學金。" }
  ];
  
  // 清空容器
  benefitsGrid.innerHTML = '';
  
  // 創建福利項目卡片
  benefits.forEach(benefit => {
    const card = document.createElement('div');
    card.className = 'welfare-card';
    
    const title = document.createElement('h4');
    title.textContent = benefit.title;
    
    const content = document.createElement('p');
    content.textContent = benefit.content;
    
    card.appendChild(title);
    card.appendChild(content);
    benefitsGrid.appendChild(card);
  });
}

      function createTCCLetters() {
        const lettersData = [
          { text: 'T', className: 'letter-t' },
          { text: 'C', className: 'letter-c1' },
          { text: 'C', className: 'letter-c2' }
        ];
        
        lettersData.forEach(ld => {
          const el = document.createElement('div');
          el.classList.add('letter', ld.className);
          el.innerText = ld.text;
          el.style.left = '50%';
          el.style.top = '50%';
          document.body.appendChild(el);
        });
      }

      /*************************************************
       * 2) 用戶信息顯示
       *************************************************/
      function updateUserInfo() {
        const username = sessionStorage.getItem('username');
        const name = sessionStorage.getItem('name');
        const role = sessionStorage.getItem('role');
        
        if (username) {
          document.getElementById('userName').textContent = name || username;
          document.getElementById('userRole').textContent = role || '';
        } else {
          // 如果沒有用戶信息，返回數資中心
          backToDataCenter();
        }
      }

      /*************************************************
       * 3) 返回數資中心
       *************************************************/
      function backToDataCenter() {
        // 添加按鈕點擊效果
        const backBtn = document.getElementById('backButton');
        backBtn.classList.add('button-clicked');
        
        // 更改按鈕顏色
        backBtn.style.background = 'linear-gradient(45deg, #4834d4, #686de0)';
        
        // 延遲執行返回操作
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 300);
      }

      /*************************************************
 * 4) 從 Google Sheets 獲取福委會公告
 *************************************************/
// 頁面加載時獲取公告
window.onload = function() {
  createTCCLetters();
  updateUserInfo();
  fetchAnnouncements();
};

// 修正獲取福委會公告的函數
function fetchAnnouncements() {
  const grid = document.getElementById('announcementGrid');
  grid.innerHTML = '<div id="loadingAnnouncements">載入公告中...</div>';
  
  // 獲取身份驗證信息
  const authToken = sessionStorage.getItem('authToken');
  const csrfToken = sessionStorage.getItem('csrfToken');
  
  if (!authToken || !csrfToken) {
    displayError("身份驗證失敗，請重新登入");
    return;
  }
  
  // 使用 Google Apps Script 作為後端 API
  const scriptUrl = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec";
  
  // 準備請求參數
  const url = `${scriptUrl}?action=getWelfareAnnouncements&authToken=${authToken}&csrfToken=${csrfToken}`;
  
  // 添加超時處理
  const controller = new AbortController();
  const timeoutId = setTimeout(() => controller.abort(), 10000); // 10秒超時
  
  // 發送請求獲取公告數據
  fetch(url, { signal: controller.signal })
    .then(response => {
      clearTimeout(timeoutId);
      if (!response.ok) {
        throw new Error("伺服器回應異常");
      }
      return response.json();
    })
    .then(data => {
      if (data.status === "success") {
        displayAnnouncements(data.announcements);
      } else {
        throw new Error(data.message || "獲取公告失敗");
      }
    })
    .catch(error => {
      console.error("Error fetching announcements:", error);
      if (error.name === 'AbortError') {
        displayError("連接超時，請檢查網絡連接後重試");
      } else {
        displayError("連接服務器失敗，請稍後再試");
      }
    });
}

// 修正顯示錯誤信息的函數
function displayError(message) {
  const grid = document.getElementById('announcementGrid');
  grid.innerHTML = `
    <div class="error-card">
      <p class="error-message">${message}</p>
      <button onclick="fetchAnnouncements()" class="retry-button">重試</button>
    </div>
  `;
}


// 顯示公告
function displayAnnouncements(announcements) {
  const grid = document.getElementById('announcementGrid');
  
  // 清除載入提示
  grid.innerHTML = '';
  
  // 檢查是否有公告
  if (!announcements || announcements.length === 0) {
    grid.innerHTML = '<p>目前沒有公告</p>';
    return;
  }
  
  // 按順位排序公告
  announcements.sort((a, b) => parseInt(a.order) - parseInt(b.order));
  
  // 創建公告卡片
  announcements.forEach(announcement => {
    const card = document.createElement('div');
    card.className = 'welfare-card';
    
    const title = document.createElement('h4');
    title.textContent = announcement.title;
    
    const content = document.createElement('p');
    content.textContent = announcement.content;
    
    card.appendChild(title);
    card.appendChild(content);
    grid.appendChild(card);
    
    // 添加淡入動畫效果
    setTimeout(() => {
      card.style.opacity = '0';
      card.style.transform = 'translateY(20px)';
      card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
      
      setTimeout(() => {
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
      }, 50);
    }, 0);
  });
}

// 顯示錯誤信息
function displayError(message) {
  const grid = document.getElementById('announcementGrid');
  grid.innerHTML = `<p class="error-message">${message}</p>`;
}

    </script>
  </body>
</html>
